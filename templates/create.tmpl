<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>添加文章</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/layui-src@2.6.8/dist/css/layui.css">
  <link rel="stylesheet" href="/static/ckeditor5/ckeditor5.css">
  <script src="https://cdn.jsdelivr.net/npm/layui-src@2.6.8/dist/layui.js"></script>
  <script type="text/javascript" src="/static/js/jquery-1.11.0.min.js"></script>
  <style>
    .layui-layer-content {
      padding-left: 30px !important;
      padding-right: 30px !important;
    }
  </style>
</head>
<body>
  <!-- 添加文章按钮 -->
  <button class="layui-btn" id="addArticle">添加文章</button>
  <div class="layui-form" id="articleForm" style="display: none;">
    <form class="layui-form" action="" lay-filter="formDemo">
      <div class="layui-row">
        <div class="layui-col-md12">
          <input type="text" name="title" required lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input">
        </div>
      </div>
      <div class="layui-row">
        <div class="layui-col-md12">
            <textarea name="content" placeholder="请输入内容" id="editor"></textarea>
        </div>
      </div>
    </form>
  </div>
  <script type="importmap">
    {
      "imports": {
        "ckeditor5": "/static/ckeditor5/ckeditor5.js",
        "ckeditor5/": "/static/ckeditor5/"
      }
    }
  </script>
  <script type="module">
    import { ClassicEditor, Essentials, Paragraph, Bold, Italic, Font, Image, ImageToolbar, ImageUpload, ImageCaption, ImageStyle, Base64UploadAdapter, Heading, Table, TableToolbar, Strikethrough, List } from 'ckeditor5';

    ClassicEditor
      .create(document.querySelector('#editor'), {
        plugins: [
          Essentials, Paragraph, Bold, Italic, Font, Image, ImageToolbar, ImageUpload, ImageCaption, ImageStyle, Base64UploadAdapter, Heading, Table, TableToolbar, Strikethrough, List
        ],
        toolbar: [
          'undo', 'redo', '|', 'heading', '|', 'bold', 'italic', 'strikethrough', '|', 'fontSize', 'fontFamily', 'fontColor', 'fontBackgroundColor', '|', 'bulletedList', 'numberedList', '|', 'insertTable', '|', 'imageUpload'
        ],
        heading: {
          options: [
            { model: 'paragraph', title: 'Paragraph', class: 'ck-heading_paragraph' },
            { model: 'heading1', view: 'h1', title: 'Heading 1', class: 'ck-heading_heading1' },
            { model: 'heading2', view: 'h2', title: 'Heading 2', class: 'ck-heading_heading2' },
            { model: 'heading3', view: 'h3', title: 'Heading 3', class: 'ck-heading_heading3' },
            { model: 'heading4', view: 'h4', title: 'Heading 4', class: 'ck-heading_heading4' },
            { model: 'heading5', view: 'h5', title: 'Heading 5', class: 'ck-heading_heading5' },
            { model: 'heading6', view: 'h6', title: 'Heading 6', class: 'ck-heading_heading6' }
          ]
        },
        image: {
          toolbar: [
            'imageTextAlternative', '|', 'imageStyle:inline', 'imageStyle:block', 'imageStyle:side'
          ]
        },
        table: {
          contentToolbar: [
            'tableColumn', 'tableRow', 'mergeTableCells'
          ]
        }
      })
      .then(editor => {
        window.editor = editor;
      })
      .catch(error => {
        console.error(error);
      });
  </script>

  <!-- A friendly reminder to run on a server, remove this during the integration. -->
  <script>
    window.onload = function() {
      if (window.location.protocol === "file:") {
        alert("This sample requires an HTTP server. Please serve this file with a web server.");
      }
    };
  </script>

  <script>
  $('#addArticle').click(function() {
    $('input[name="title"]').val('');
    window.editor.setData('')
    layer.open({
      type: 1,
      title: '添加文章',
      content: $('#articleForm'),
      area: ['100%', '100%'],
      btn: ['创建'],
      yes: function(index, layero) {
            alert($('input[name="title"]').val());
            var content = window.editor.getData(); // 获取编辑器内容
            alert(content);
      },
      cancel: function() {
        $('#articleForm').hide();
      },
      success: function(layero, index) {
      }
    });
  });
  </script>
</body>
</html>